# Denegar acceso directo a db.php

<Files "db.php">
Order allow,deny
Deny from all
</Files>

# Reglas adicionales de seguridad

<Files "\*.php"> # Permitir acceso solo a archivos específicos
<FilesMatch "^(licencia|index|login)\.php$">
Order allow,deny
Allow from all
</FilesMatch>
</Files>

# Prevenir acceso a archivos de configuración

<FilesMatch "\.(htaccess|htpasswd|ini|log|sh|inc|bak)$">
Order allow,deny
Deny from all
</FilesMatch>

# Proteger contra ataques de inyección

<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{QUERY_STRING} (<|%3C).*script.*(>|%3E) [NC,OR]
    RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
    RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2}) [OR]
    RewriteCond %{QUERY_STRING} ^.*(\[|\]|\(|\)|<|>).* [NC,OR]
    RewriteCond %{QUERY_STRING} (NULL|OUTFILE|LOAD_FILE) [OR]
    RewriteCond %{QUERY_STRING} (\./|\../|\.../) [NC,OR]
    RewriteCond %{QUERY_STRING} ^.*(:|;).* [NC,OR]
    RewriteCond %{QUERY_STRING} ^.*(\||`).* [NC]
    RewriteRule ^(.*)$ - [F,L]
</IfModule>
